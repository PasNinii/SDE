#===============================================================================
# FROM
#-------------------------------------------------------------------------------
# Base image
#===============================================================================
FROM node


#===============================================================================
# WORKDIR
#-------------------------------------------------------------------------------
# Tells docker to run the following commands in the /app directory
#===============================================================================
WORKDIR /app


#===============================================================================
# COPY
#-------------------------------------------------------------------------------
# From local directory to the container
#------------------------------------------------------------------------------- 
# Takes a snapshot of the local directory and copy it to the container
# If you change the local directory, you need to rebuild the image
#-------------------------------------------------------------------------------
# Layers are cached, package.json is not changed often, so it's a good idea to
# copy it first
#===============================================================================
COPY package.json .


#===============================================================================
# RUN
#-------------------------------------------------------------------------------
# By default, run command are executed in root directory or WORKDIR
# RUN instructions are executed when creating the image
#===============================================================================
RUN npm install


#===============================================================================
# COPY
#-------------------------------------------------------------------------------
# Local file are most likely to change, so it's better to copy them after
# installing dependencies
#===============================================================================
COPY . .


#===============================================================================
# EXPOSE
#-------------------------------------------------------------------------------
# This is not mandatory, but it's a good practice to show which port you plan
# to use
#-------------------------------------------------------------------------------
# $ docker run -p host:container to map host port to container port
#===============================================================================
EXPOSE 80


#===============================================================================
# CMD
#-------------------------------------------------------------------------------
# CMD instructions are executed when the container is started
#===============================================================================
CMD ["npm", "run", "start"]

